{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%E5%B2%A1%E6%9C%AC%E3%80%80%E6%99%83%E4%B8%80/projects/kobe-maruka-project/web/src/components/AllocationForm.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { mutate } from 'swr';\r\n\r\ninterface AllocationFormProps {\r\n    selectedSupplyId: string | null;\r\n}\r\n\r\nexport default function AllocationForm({ selectedSupplyId }: AllocationFormProps) {\r\n    const [customerName, setCustomerName] = useState('');\r\n    const [quantity, setQuantity] = useState('');\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [message, setMessage] = useState('');\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!selectedSupplyId) return;\r\n\r\n        setIsSubmitting(true);\r\n        setMessage('');\r\n\r\n        try {\r\n            const res = await fetch('/api/allocate', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    supplyId: selectedSupplyId,\r\n                    customerName,\r\n                    quantity: Number(quantity),\r\n                }),\r\n            });\r\n\r\n            const data = await res.json();\r\n\r\n            if (!res.ok) {\r\n                throw new Error(data.error || 'Allocation failed');\r\n            }\r\n\r\n            setMessage('Allocation successful!');\r\n            setCustomerName('');\r\n            setQuantity('');\r\n\r\n            // Optimistic update or revalidation\r\n            mutate('/api/supplies');\r\n\r\n        } catch (error: any) {\r\n            setMessage(`Error: ${error.message}`);\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    if (!selectedSupplyId) {\r\n        return <div style={{ padding: '20px', border: '1px solid #ccc' }}>Select a supply from the grid to allocate.</div>;\r\n    }\r\n\r\n    return (\r\n        <div style={{ padding: '20px', border: '1px solid #ccc', marginTop: '20px' }}>\r\n            <h3>Allocation Form</h3>\r\n            <form onSubmit={handleSubmit} style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\r\n                <div>\r\n                    <label>Supply ID: </label>\r\n                    <strong>{selectedSupplyId}</strong>\r\n                </div>\r\n                <div>\r\n                    <label>Customer Name: </label>\r\n                    <input\r\n                        type=\"text\"\r\n                        value={customerName}\r\n                        onChange={(e) => setCustomerName(e.target.value)}\r\n                        required\r\n                        style={{ border: '1px solid black', padding: '4px' }}\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <label>Quantity: </label>\r\n                    <input\r\n                        type=\"number\"\r\n                        value={quantity}\r\n                        onChange={(e) => setQuantity(e.target.value)}\r\n                        required\r\n                        min=\"1\"\r\n                        style={{ border: '1px solid black', padding: '4px' }}\r\n                    />\r\n                </div>\r\n                <button\r\n                    type=\"submit\"\r\n                    disabled={isSubmitting}\r\n                    style={{ border: '1px solid black', padding: '8px', background: '#eee', cursor: 'pointer' }}\r\n                >\r\n                    {isSubmitting ? 'Allocating...' : 'Confirm Allocation'}\r\n                </button>\r\n            </form>\r\n            {message && <p style={{ marginTop: '10px', fontWeight: 'bold' }}>{message}</p>}\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AASe,SAAS,eAAe,EAAE,gBAAgB,EAAuB;;IAC5E,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yNAAQ,EAAC;IACjD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yNAAQ,EAAC;IACzC,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yNAAQ,EAAC;IACjD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yNAAQ,EAAC;IAEvC,MAAM,eAAe,OAAO;QACxB,EAAE,cAAc;QAChB,IAAI,CAAC,kBAAkB;QAEvB,gBAAgB;QAChB,WAAW;QAEX,IAAI;YACA,MAAM,MAAM,MAAM,MAAM,iBAAiB;gBACrC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBACjB,UAAU;oBACV;oBACA,UAAU,OAAO;gBACrB;YACJ;YAEA,MAAM,OAAO,MAAM,IAAI,IAAI;YAE3B,IAAI,CAAC,IAAI,EAAE,EAAE;gBACT,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI;YAClC;YAEA,WAAW;YACX,gBAAgB;YAChB,YAAY;YAEZ,oCAAoC;YACpC,IAAA,6QAAM,EAAC;QAEX,EAAE,OAAO,OAAY;YACjB,WAAW,CAAC,OAAO,EAAE,MAAM,OAAO,EAAE;QACxC,SAAU;YACN,gBAAgB;QACpB;IACJ;IAEA,IAAI,CAAC,kBAAkB;QACnB,qBAAO,6OAAC;YAAI,OAAO;gBAAE,SAAS;gBAAQ,QAAQ;YAAiB;sBAAG;;;;;;IACtE;IAEA,qBACI,6OAAC;QAAI,OAAO;YAAE,SAAS;YAAQ,QAAQ;YAAkB,WAAW;QAAO;;0BACvE,6OAAC;0BAAG;;;;;;0BACJ,6OAAC;gBAAK,UAAU;gBAAc,OAAO;oBAAE,SAAS;oBAAQ,eAAe;oBAAU,KAAK;gBAAO;;kCACzF,6OAAC;;0CACG,6OAAC;0CAAM;;;;;;0CACP,6OAAC;0CAAQ;;;;;;;;;;;;kCAEb,6OAAC;;0CACG,6OAAC;0CAAM;;;;;;0CACP,6OAAC;gCACG,MAAK;gCACL,OAAO;gCACP,UAAU,CAAC,IAAM,gBAAgB,EAAE,MAAM,CAAC,KAAK;gCAC/C,QAAQ;gCACR,OAAO;oCAAE,QAAQ;oCAAmB,SAAS;gCAAM;;;;;;;;;;;;kCAG3D,6OAAC;;0CACG,6OAAC;0CAAM;;;;;;0CACP,6OAAC;gCACG,MAAK;gCACL,OAAO;gCACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;gCAC3C,QAAQ;gCACR,KAAI;gCACJ,OAAO;oCAAE,QAAQ;oCAAmB,SAAS;gCAAM;;;;;;;;;;;;kCAG3D,6OAAC;wBACG,MAAK;wBACL,UAAU;wBACV,OAAO;4BAAE,QAAQ;4BAAmB,SAAS;4BAAO,YAAY;4BAAQ,QAAQ;wBAAU;kCAEzF,eAAe,kBAAkB;;;;;;;;;;;;YAGzC,yBAAW,6OAAC;gBAAE,OAAO;oBAAE,WAAW;oBAAQ,YAAY;gBAAO;0BAAI;;;;;;;;;;;;AAG9E;GAxFwB;KAAA"}},
    {"offset": {"line": 220, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%E5%B2%A1%E6%9C%AC%E3%80%80%E6%99%83%E4%B8%80/projects/kobe-maruka-project/web/src/components/StockManager.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\nimport useSWR from 'swr';\r\nimport { AgGridReact } from 'ag-grid-react';\r\nimport { ColDef, ModuleRegistry } from 'ag-grid-community';\r\nimport { ClientSideRowModelModule } from 'ag-grid-community';\r\nimport 'ag-grid-community/styles/ag-grid.css';\r\nimport 'ag-grid-community/styles/ag-theme-alpine.css';\r\nimport { Supply } from '@/types/schema';\r\nimport AllocationForm from './AllocationForm';\r\n\r\n// Register AG Grid modules\r\nModuleRegistry.registerModules([ClientSideRowModelModule]);\r\n\r\nconst fetcher = (url: string) => fetch(url).then((res) => res.json());\r\n\r\nexport default function StockManager() {\r\n    const { data: supplies, error, isLoading } = useSWR<Supply[]>('/api/supplies', fetcher, { refreshInterval: 1000 });\r\n    const [selectedSupplyId, setSelectedSupplyId] = useState<string | null>(null);\r\n\r\n    const columnDefs: ColDef<Supply>[] = [\r\n        { field: 'productName', headerName: 'Product Name', flex: 1 },\r\n        { field: 'currentQuantity', headerName: 'Current Qty', flex: 1 },\r\n        { field: 'status', headerName: 'Status', flex: 1 },\r\n        { field: 'id', headerName: 'ID', hide: true },\r\n    ];\r\n\r\n    if (error) return <div>Failed to load supplies</div>;\r\n    if (isLoading) return <div>Loading...</div>;\r\n\r\n    return (\r\n        <div style={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\r\n            <div className=\"ag-theme-alpine\" style={{ height: '400px', width: '100%' }}>\r\n                <AgGridReact\r\n                    rowData={supplies}\r\n                    columnDefs={columnDefs}\r\n                    rowSelection=\"single\"\r\n                    onRowClicked={(event) => setSelectedSupplyId(event.data?.id || null)}\r\n                    animateRows={true}\r\n                />\r\n            </div>\r\n            <AllocationForm selectedSupplyId={selectedSupplyId} supplies={supplies} />\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAKA;;;AAVA;;;;;;;;;AAYA,2BAA2B;AAC3B,+OAAc,CAAC,eAAe,CAAC;IAAC,yPAAwB;CAAC;AAEzD,MAAM,UAAU,CAAC,MAAgB,MAAM,KAAK,IAAI,CAAC,CAAC,MAAQ,IAAI,IAAI;AAEnD,SAAS;;IACpB,MAAM,EAAE,MAAM,QAAQ,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,IAAA,4NAAM,EAAW,iBAAiB,SAAS;QAAE,iBAAiB;IAAK;IAChH,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yNAAQ,EAAgB;IAExE,MAAM,aAA+B;QACjC;YAAE,OAAO;YAAe,YAAY;YAAgB,MAAM;QAAE;QAC5D;YAAE,OAAO;YAAmB,YAAY;YAAe,MAAM;QAAE;QAC/D;YAAE,OAAO;YAAU,YAAY;YAAU,MAAM;QAAE;QACjD;YAAE,OAAO;YAAM,YAAY;YAAM,MAAM;QAAK;KAC/C;IAED,IAAI,OAAO,qBAAO,6OAAC;kBAAI;;;;;;IACvB,IAAI,WAAW,qBAAO,6OAAC;kBAAI;;;;;;IAE3B,qBACI,6OAAC;QAAI,OAAO;YAAE,QAAQ;YAAQ,SAAS;YAAQ,eAAe;QAAS;;0BACnE,6OAAC;gBAAI,WAAU;gBAAkB,OAAO;oBAAE,QAAQ;oBAAS,OAAO;gBAAO;0BACrE,cAAA,6OAAC,yOAAW;oBACR,SAAS;oBACT,YAAY;oBACZ,cAAa;oBACb,cAAc,CAAC,QAAU,oBAAoB,MAAM,IAAI,EAAE,MAAM;oBAC/D,aAAa;;;;;;;;;;;0BAGrB,6OAAC,kMAAc;gBAAC,kBAAkB;gBAAkB,UAAU;;;;;;;;;;;;AAG1E;GA5BwB;;QACyB,4NAAM;;;KAD/B"}}]
}